<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bottle Swap Game</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 1em;
    }

    .bottle-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin: 20px 0;
    }

    .bottle {
      width: 60px;
      height: 150px;
      cursor: pointer;
      border: 3px solid transparent;
      transition: transform 0.2s, border-color 0.2s;
    }

    .bottle:active {
      transform: scale(1.05);
    }

    .selected {
      border-color: black;
    }

    #feedback {
      font-size: 1.2em;
      margin-top: 15px;
    }

    #tries {
      font-weight: bold;
    }

    .end-message {
      font-size: 1.5em;
      color: red;
      margin-top: 20px;
    }

    @media (max-width: 500px) {
      .bottle {
        width: 50px;
        height: 120px;
      }

      h2 {
        font-size: 1.3em;
      }

      #feedback {
        font-size: 1em;
      }
    }
  </style>
</head>
<body>

<h2>üîÑ Bottle Guessing Game</h2>
<p>Tap two bottles to swap. You have 8 tries to get them in the correct order.</p>

<div class="bottle-container" id="bottles"></div>
<p id="feedback"></p>
<p id="tries">Tries: 0 / 8</p>
<p class="end-message" id="endMessage"></p>

<script>
  // Image filenames corresponding to bottles
  const bottleImages = [
    "bottle_1.png",  // red
    "bottle_2.png",  // blue
    "bottle_3.png",  // green
    "bottle_4.png",  // yellow
    "bottle_5.png"   // purple
  ];

  const groundTruth = [...bottleImages].sort(() => Math.random() - 0.5);
  let currentOrder = [...bottleImages].sort(() => Math.random() - 0.5);
  let selected = [];
  let tries = 0;
  let gameOver = false;

  const bottlesDiv = document.getElementById("bottles");
  const feedback = document.getElementById("feedback");
  const triesText = document.getElementById("tries");
  const endMessage = document.getElementById("endMessage");

  function renderBottles() {
    bottlesDiv.innerHTML = "";
    currentOrder.forEach((imgSrc, index) => {
      const img = document.createElement("img");
      img.src = imgSrc;
      img.className = "bottle";
      img.dataset.index = index;
      if (selected.includes(index)) img.classList.add("selected");
      img.onclick = () => handleClick(index);
      bottlesDiv.appendChild(img);
    });
  }

  function handleClick(index) {
    if (gameOver) return;

    if (selected.includes(index)) {
      selected = selected.filter(i => i !== index);
    } else {
      selected.push(index);
      if (selected.length === 2) {
        swapBottles(selected[0], selected[1]);
        selected = [];
        tries++;
        checkCorrect();
      }
    }
    renderBottles();
  }

  function swapBottles(i, j) {
    [currentOrder[i], currentOrder[j]] = [currentOrder[j], currentOrder[i]];
  }

  function checkCorrect() {
    let correct = 0;
    for (let i = 0; i < currentOrder.length; i++) {
      if (currentOrder[i] === groundTruth[i]) correct++;
    }

    feedback.textContent = `${correct} bottle(s) in the correct position`;
    triesText.textContent = `Tries: ${tries} / 8`;

    if (correct === currentOrder.length) {
      endMessage.textContent = "üéâ You win!";
      gameOver = true;
    } else if (tries >= 8) {
      endMessage.textContent = "‚ùå You lose!";
      gameOver = true;
    }
  }

  renderBottles();
</script>

</body>
</html>
